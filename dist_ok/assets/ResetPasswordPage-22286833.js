import{r as t,o as S,a as b,be as y,t as x,j as e,J as C,_ as P,$ as E,a0 as k,K as L,L as f,Z as v,ab as R,M as _,B as q,q as D,ac as T}from"./index-1d87757c.js";const F=()=>{const[r,w]=t.useState(""),[d,j]=t.useState(""),[l,u]=t.useState(!1),[i,g]=t.useState(!1),[h,n]=t.useState(""),{toast:o}=S(),c=b(),m=y();t.useEffect(()=>{const s=m.hash.substring(1),a=new URLSearchParams(s),p=a.get("access_token");a.get("error_description")?(o({title:"Link Inválido ou Expirado",description:"O link para redefinição de senha não é mais válido. Por favor, solicite um novo.",variant:"destructive",duration:8e3}),c("/esqueci-senha")):p&&x.auth.setSession({access_token:p,refresh_token:""})},[m,c,o]);const N=async s=>{if(s.preventDefault(),n(""),r.length<6){n("A senha deve ter no mínimo 6 caracteres.");return}if(r!==d){n("As senhas não coincidem.");return}u(!0);const{error:a}=await x.auth.updateUser({password:r});u(!1),a?(o({title:"Erro ao redefinir senha",description:a.message,variant:"destructive"}),n(a.message)):(o({title:"Senha redefinida com sucesso!",description:"Você já pode fazer login com sua nova senha.",variant:"success"}),c("/?auth=login"))};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs(C,{className:"w-full max-w-md shadow-lg",children:[e.jsxs(P,{className:"text-center",children:[e.jsx(E,{className:"text-2xl",children:"Redefinir sua senha"}),e.jsx(k,{children:"Crie uma nova senha para sua conta."})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{htmlFor:"password",children:"Nova Senha"}),e.jsx(v,{id:"password",type:i?"text":"password",value:r,onChange:s=>w(s.target.value),required:!0,placeholder:"••••••••"}),e.jsx("button",{type:"button",onClick:()=>g(!i),className:"absolute right-3 top-8 text-gray-500",children:i?e.jsx(R,{className:"h-5 w-5"}):e.jsx(_,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"confirmPassword",children:"Confirmar Nova Senha"}),e.jsx(v,{id:"confirmPassword",type:"password",value:d,onChange:s=>j(s.target.value),required:!0,placeholder:"••••••••"})]}),h&&e.jsx("p",{className:"text-red-500 text-sm text-center",children:h}),e.jsxs(q,{type:"submit",disabled:l,className:"w-full btn-gradient text-white",children:[l?e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(T,{className:"mr-2 h-4 w-4"}),"Salvar Nova Senha"]})]})})]})})};export{F as default};
