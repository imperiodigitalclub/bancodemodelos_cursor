import{a as X,j as e,E as Y,s as J,b as K,B as h,M as ae,Q as te,L as k,g as C,h as w,i as S,k as _,l as d,u as re,o as le,r as x,d as Q,q as oe,t as ie}from"./index-1d87757c.js";import{a as D,b as R,c as B,T as ne}from"./tooltip-d02ea239.js";import{S as ce}from"./shield-check-7b3002bb.js";import{M as de}from"./map-pin-b62a81cc.js";import{M as me}from"./message-circle-abaca2d5.js";import{b as Z}from"./jobOptions-1997529c.js";import{T as ee}from"./trash-2-18ebab21.js";import{S as xe,a as he,b as pe,c as ue,d as fe,e as je,f as ge,g as ve}from"./sheet-74228ed3.js";import{S as be}from"./sliders-horizontal-0f7afeec.js";const W=({contractor:a,onContact:p,onFavorite:n})=>{const m=X(),i=()=>{a.profile_slug&&m(`/perfil/${a.profile_slug}`)};return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden card-hover animate-fade-in flex flex-col",children:[e.jsxs("div",{className:"relative group cursor-pointer",onClick:i,children:[e.jsx("img",{className:"w-full h-64 sm:h-72 object-cover transition-transform duration-300 group-hover:scale-105",alt:`Foto de perfil de ${a.name||a.company_name}`,src:a.profile_image_url||"https://images.unsplash.com/photo-1600880292203-757bb62b4baf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=870&q=80"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"absolute top-2 left-2 sm:top-3 sm:left-3 flex flex-col gap-1.5 sm:gap-2",children:[a.subscription_type==="pro"&&e.jsxs(Y,{variant:"default",className:"bg-gradient-to-r from-yellow-400 to-amber-500 text-white px-2 py-1 text-xs font-bold flex items-center gap-1 shadow-lg border-none",children:[e.jsx(J,{className:"h-3 w-3"})," PRO"]}),a.is_verified&&e.jsxs(Y,{variant:"default",className:"bg-gradient-to-r from-blue-400 to-cyan-500 text-white px-2 py-1 text-xs font-bold flex items-center gap-1 shadow-lg border-none",children:[e.jsx(ce,{className:"h-3 w-3"})," Verificado"]})]})]}),e.jsxs("div",{className:"p-3 flex flex-col flex-grow",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate hover:text-pink-600 cursor-pointer",onClick:i,children:a.name||"Profissional"}),a.company_name&&e.jsxs("p",{className:"text-xs text-gray-500 truncate mt-0.5 flex items-center",children:[e.jsx(K,{size:12,className:"mr-1.5 text-gray-400 flex-shrink-0"}),a.company_name]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-600 mt-1",children:[e.jsx(de,{size:13,className:"mr-1.5 text-gray-500 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[a.city||"N/A",", ",a.state||"N/A"]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2 mb-2.5 flex-grow h-8 line-clamp-2",children:a.company_details||a.bio||"Sem descrição."}),e.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-auto pt-2 border-t border-gray-100",children:[e.jsxs(D,{children:[e.jsx(R,{asChild:!0,children:e.jsx(h,{onClick:i,variant:"ghost",size:"icon",className:"w-8 h-8 hover:bg-pink-100",children:e.jsx(ae,{className:"h-4 w-4 text-pink-600"})})}),e.jsx(B,{children:e.jsx("p",{children:"Ver Perfil"})})]}),e.jsxs(D,{children:[e.jsx(R,{asChild:!0,children:e.jsx(h,{onClick:()=>p(a),variant:"ghost",size:"icon",className:"w-8 h-8 hover:bg-pink-100",children:e.jsx(me,{className:"h-4 w-4 text-pink-600"})})}),e.jsx(B,{children:e.jsx("p",{children:"Contatar"})})]}),e.jsxs(D,{children:[e.jsx(R,{asChild:!0,children:e.jsx(h,{onClick:u=>{u.stopPropagation(),n(a.id)},variant:"ghost",size:"icon",className:"w-8 h-8 hover:bg-pink-100",children:e.jsx(te,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(B,{children:e.jsx("p",{children:"Mais Informações (Em breve)"})})]})]})]})]})},ye=({sortBy:a,setSortBy:p,sortOptions:n,filterContractorType:m,setFilterContractorType:i,contractorTypes:u,filterState:f,setFilterState:j,clearFilters:g})=>{const v="all";return e.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"sortByContractorDesktop",className:"text-sm font-medium text-gray-700",children:"Ordenar Por"}),e.jsxs(C,{value:a,onValueChange:p,children:[e.jsx(w,{id:"sortByContractorDesktop",className:"w-full mt-1 py-2.5 h-auto",children:e.jsx(S,{placeholder:"Ordenar por..."})}),e.jsx(_,{children:n.map(r=>e.jsx(d,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"filterContractorTypeDesktop",className:"text-sm font-medium text-gray-700",children:"Tipo de Profissional"}),e.jsxs(C,{value:m,onValueChange:i,children:[e.jsx(w,{id:"filterContractorTypeDesktop",className:"w-full mt-1 py-2.5 h-auto",children:e.jsx(S,{placeholder:"Todos"})}),e.jsxs(_,{children:[e.jsx(d,{value:v,children:"Todos"}),u.map(r=>e.jsx(d,{value:r.value,children:r.label},r.value))]})]})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"filterStateContractorDesktop",className:"text-sm font-medium text-gray-700",children:"Estado (UF)"}),e.jsxs(C,{value:f,onValueChange:j,children:[e.jsx(w,{id:"filterStateContractorDesktop",className:"w-full mt-1 py-2.5 h-auto",children:e.jsx(S,{placeholder:"Todos"})}),e.jsxs(_,{children:[e.jsx(d,{value:v,children:"Todos"}),Z.map(r=>e.jsx(d,{value:r.value,children:r.label},r.value))]})]})]}),e.jsxs(h,{onClick:()=>g(!1),variant:"outline",className:"w-full lg:w-auto self-end py-2.5 h-auto",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"})," Limpar Filtros"]})]})},Ne=({sortBy:a,setSortBy:p,sortOptions:n,filterContractorType:m,setFilterContractorType:i,contractorTypes:u,filterState:f,setFilterState:j,clearFilters:g,showFiltersSheet:v,setShowFiltersSheet:r})=>{const T="all";return e.jsxs("div",{className:"md:hidden w-full flex gap-2",children:[e.jsxs(C,{value:a,onValueChange:p,className:"flex-1",children:[e.jsx(w,{id:"sortByContractorMobile",className:"w-full py-2.5 h-auto",children:e.jsx(S,{placeholder:"Ordenar por..."})}),e.jsx(_,{children:n.map(t=>e.jsx(d,{value:t.value,children:t.label},t.value))})]}),e.jsxs(xe,{open:v,onOpenChange:r,children:[e.jsx(he,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"flex-1 py-2.5 h-auto",children:[e.jsx(be,{className:"h-5 w-5 mr-2"})," Filtros"]})}),e.jsxs(pe,{side:"bottom",className:"h-[70vh] flex flex-col",children:[e.jsxs(ue,{className:"p-4 border-b",children:[e.jsx(fe,{children:"Filtros Avançados"}),e.jsx(je,{children:"Encontre o profissional certo."})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4 scrollbar-thin",children:e.jsxs("div",{className:"space-y-4 p-1",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"filterContractorTypeMobile",className:"text-sm font-medium text-gray-700",children:"Tipo de Profissional"}),e.jsxs(C,{value:m,onValueChange:i,children:[e.jsx(w,{id:"filterContractorTypeMobile",className:"w-full mt-1 py-2.5 h-auto",children:e.jsx(S,{placeholder:"Todos os tipos"})}),e.jsxs(_,{children:[e.jsx(d,{value:T,children:"Todos os tipos"}),u.map(t=>e.jsx(d,{value:t.value,children:t.label},t.value))]})]})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"filterStateContractorMobile",className:"text-sm font-medium text-gray-700",children:"Estado (UF)"}),e.jsxs(C,{value:f,onValueChange:j,children:[e.jsx(w,{id:"filterStateContractorMobile",className:"w-full mt-1 py-2.5 h-auto",children:e.jsx(S,{placeholder:"Todos os estados"})}),e.jsxs(_,{children:[e.jsx(d,{value:T,children:"Todos os estados"}),Z.map(t=>e.jsx(d,{value:t.value,children:t.label},t.value))]})]})]})]})}),e.jsxs(ge,{className:"p-4 border-t flex-col sm:flex-row gap-2",children:[e.jsxs(h,{variant:"outline",onClick:()=>g(!0),className:"w-full py-2.5 h-auto",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Limpar"]}),e.jsx(ve,{asChild:!0,children:e.jsx(h,{className:"w-full btn-gradient py-2.5 h-auto",children:"Aplicar"})})]})]})]})]})},Ee=()=>{const{user:a,openAuthModal:p}=re(),{toast:n}=le(),m=X(),[i,u]=x.useState(""),[f,j]=x.useState(!0),[g,v]=x.useState([]),r="all",T=10,[t,V]=x.useState("pro_random"),[b,L]=x.useState(r),[se,I]=x.useState(!1),O=[{value:"contractor",label:"Contratante"},{value:"photographer",label:"Fotógrafo(a)"}],[y,A]=x.useState(r),U=[{value:"pro_random",label:"🌟 Destaque Aleatório"},{value:"pro_recent",label:"🌟 Destaque Recentes"},{value:"recent",label:"⏳ Mais Recentes (Geral)"},{value:"oldest",label:"🕰️ Mais Antigos (Geral)"},{value:"random",label:"🎲 Aleatório (Geral)"}],E=s=>{let l=s.length,c;for(;l!==0;)c=Math.floor(Math.random()*l),l--,[s[l],s[c]]=[s[c],s[l]];return s};x.useEffect(()=>{(async()=>{j(!0);try{let l=ie.from("profiles").select("*").in("user_type",["contractor","photographer"]);t==="pro_recent"||t==="recent"?l=l.order("created_at",{ascending:!1}):t==="oldest"&&(l=l.order("created_at",{ascending:!0}));const{data:c,error:o}=await l;if(o)throw o.code!=="SUPABASE_INIT_ERROR"&&n({title:"Erro ao buscar contratantes",description:o.message,variant:"destructive"}),o;v(c||[])}catch(l){console.error("Erro em fetchContractors:",l)}finally{j(!1)}})()},[n,t]);const q=s=>{if(!a){p();return}if(!a.subscription_type&&a.user_type!=="admin"){n({title:"Acesso Exclusivo Pro",description:"Apenas assinantes Pro podem enviar mensagens. Faça o upgrade para se conectar!",variant:"destructive"}),m("/dashboard",{state:{tab:"subscription"}});return}m("/mensagens",{state:{profile:s}})},z=s=>{if(!a){p();return}n({title:"🚧 Em construção!",description:"Funcionalidade de favoritos em breve."})},{proContractorsList:F,commonContractorsList:M}=x.useMemo(()=>{let s=[...g].filter(o=>{var N,H,$;return(((N=o.name)==null?void 0:N.toLowerCase())||"").includes(i.toLowerCase())||(((H=o.company_name)==null?void 0:H.toLowerCase())||"").includes(i.toLowerCase())||((($=o.city)==null?void 0:$.toLowerCase())||"").includes(i.toLowerCase())});b&&b!==r&&(s=s.filter(o=>o.state===b)),y&&y!==r&&(s=s.filter(o=>o.user_type===y));let l=s.filter(o=>o.subscription_type==="pro"),c=s.filter(o=>o.subscription_type!=="pro");if(t==="pro_random")l=E(l),c=E(c);else if(t!=="pro_recent"){if(t==="random"){const o=E(s);l=o.filter(N=>N.subscription_type==="pro"),c=o.filter(N=>N.subscription_type!=="pro")}}return{proContractorsList:l.slice(0,T),commonContractorsList:[...l.slice(T),...c]}},[g,i,b,y,t]),P=(s=!0)=>{u(""),L(r),A(r),s&&I(!1)},G=F.length+M.length;return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-2 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2",children:[e.jsx(K,{className:"h-7 w-7 sm:h-8 sm:w-8 text-pink-500"})," ",e.jsx("span",{children:"Encontre"})," ",e.jsx("span",{className:"gradient-text",children:"Parceiros Estratégicos"})]}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 max-w-2xl mx-auto",children:"Contratantes e fotógrafos para impulsionar seus projetos."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg flex-1 w-full md:w-auto",children:[e.jsx(Q,{className:"ml-3 text-gray-400 h-5 w-5 flex-shrink-0"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, empresa ou cidade...",value:i,onChange:s=>u(s.target.value),className:"w-full pl-2 pr-4 py-3 border-none rounded-r-lg focus:ring-0"})]}),e.jsx(Ne,{sortBy:t,setSortBy:V,sortOptions:U,filterContractorType:y,setFilterContractorType:A,contractorTypes:O,filterState:b,setFilterState:L,clearFilters:P,showFiltersSheet:se,setShowFiltersSheet:I})]}),e.jsx(ye,{sortBy:t,setSortBy:V,sortOptions:U,filterContractorType:y,setFilterContractorType:A,contractorTypes:O,filterState:b,setFilterState:L,clearFilters:P})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-600",children:f?"Carregando profissionais...":`Encontrados ${G} profissionais`})}),f?e.jsx("div",{className:"flex justify-center items-center py-16",children:e.jsx(oe,{className:"h-12 w-12 text-pink-500 animate-spin"})}):e.jsx(ne,{delayDuration:100,children:G===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Q,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nenhum profissional encontrado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Tente ajustar os filtros ou termos de busca"}),e.jsx(h,{onClick:()=>P(!1),variant:"outline",className:"py-2.5 h-auto",children:"Limpar Filtros"})]}):e.jsxs(e.Fragment,{children:[F.length>0&&e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-2 flex items-center",children:[e.jsx(J,{className:"h-6 w-6 mr-2 text-yellow-500"})," Profissionais em Destaque PRO"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Profissionais PRO com visibilidade premium. ",e.jsx(h,{variant:"link",onClick:()=>m("/dashboard",{state:{tab:"subscription"}}),className:"text-pink-600 p-0 h-auto",children:"Assine PRO e apareça aqui!"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",children:F.map(s=>e.jsx(W,{contractor:s,onContact:q,onFavorite:z},s.id))})]}),M.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:F.length>0?"Mais Profissionais":"Profissionais"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",children:M.map(s=>e.jsx(W,{contractor:s,onContact:q,onFavorite:z},s.id))})]})]})})]})})};export{Ee as default};
