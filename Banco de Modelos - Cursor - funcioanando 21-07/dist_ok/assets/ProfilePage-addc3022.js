import{c as U,a5 as Ae,b as ge,S as Re,j as e,E as W,s as Me,B as P,ak as Le,q as pe,O as ee,N as Fe,p as de,al as Pe,r as x,a as je,P as Y,u as ae,o as J,C as ve,D as te,v as re,w as ie,x as ne,z as le,t as F,Q as fe,U as Ee,am as Oe,e as qe,T as Ve,V as ze,Y as Be,R as Ue,an as He,M as Ge,ao as Ze,ap as Ke,aq as We,X as Ye,L,Z as K,g as me,h as xe,i as he,k as ue,l as X,G as De,af as ye,ae as be,y as Xe,ai as Je}from"./index-1d87757c.js";import{S as $e}from"./shield-check-7b3002bb.js";import{a as _e,T as Qe}from"./textarea-bd3e9a46.js";import{a as es,S as ss,u as as,P as ts}from"./PaymentDisabledModal-0234c645.js";import{M as rs}from"./message-circle-abaca2d5.js";import{M as se}from"./mail-8703cb89.js";import{P as is,U as ns,D as Ne,a as ls,f as os,b as cs,v as ds}from"./verificationFormUtils-4c5770fb.js";import{T as ms,a as xs,b as hs,c as us}from"./tooltip-d02ea239.js";import{G as gs}from"./GalleryTab-d1ceb71a.js";import{M as ps}from"./map-pin-b62a81cc.js";import{M as js}from"./ModelCard-788ac87e.js";import{M as vs}from"./MediaForm-2d488de0.js";import"./ProfileFormHandler-24dd2d47.js";import"./crop-74373485.js";import"./trash-2-18ebab21.js";const fs=U("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]),ys=U("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]),bs=U("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]),_s=U("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Te=U("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Ie=U("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Ns=U("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),ws=U("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]),we=({stats:s,profile:i,canHaveGallery:t,layout:a="desktop"})=>{const d=i.user_type==="model",o=[...t?[{label:"Mídia",value:s.media,icon:Ae}]:[],{label:d?"Candidaturas":"Vagas Publicadas",value:s.jobs,icon:ge},{label:"Avaliação",value:`${s.rating}`,icon:Re}];return a==="mobile"?e.jsx("div",{className:"flex justify-around items-center text-center w-full mt-1",children:o.map((r,h)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-bold text-gray-800 text-sm",children:r.value}),e.jsx("span",{className:"text-xs text-gray-500",children:r.label})]},h))}):e.jsx("div",{className:"flex flex-wrap gap-x-3 gap-y-1 sm:gap-x-4 items-center",children:o.map((r,h)=>e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-600",children:[e.jsx(r.icon,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1 text-pink-500"}),e.jsx("span",{className:"font-medium text-gray-800 mr-0.5",children:r.value}),e.jsxs("span",{className:"hidden sm:inline",children:[r.label,r.label==="Avaliação"?` (${i.rating_count||0})`:""]})]},h))})},Ce=({profile:s,isProActive:i,layout:t="mobile"})=>{const a="text-xs font-bold uppercase py-1 px-2 rounded text-center shadow-sm",d="text-[10px] font-bold uppercase py-1 px-2 rounded text-center shadow-sm";return t==="mobile"?e.jsxs("div",{className:"mt-2 space-y-1 w-full",children:[e.jsx("div",{className:`${d} ${s.is_verified?"bg-blue-500 text-white":"bg-gray-200 text-gray-400 opacity-60"}`,style:{fontSize:s.is_verified?"10px":"9px"},children:"Verificado"}),e.jsx("div",{className:`${a} ${i?"bg-yellow-400 text-gray-800":"bg-gray-200 text-gray-400 opacity-60"}`,style:{fontSize:i?"10px":"9px"},children:"PRO"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(W,{variant:"default",className:`px-2 py-1 text-xs font-bold flex items-center gap-1 shadow-lg border-none ${i?"bg-gradient-to-r from-yellow-400 to-amber-500":"bg-gray-300 text-gray-500 opacity-60"}`,children:[e.jsx(Me,{className:`h-3 w-3 ${i?"text-white":"text-gray-400"}`}),e.jsx("span",{className:`${i?"text-white":"text-gray-500"}`,children:"PRO"})]}),e.jsxs(W,{variant:"default",className:`px-2 py-1 text-xs font-bold flex items-center gap-1 shadow-lg border-none ${s.is_verified?"bg-gradient-to-r from-blue-500 to-sky-600":"bg-gray-300 text-gray-500 opacity-60"}`,children:[e.jsx($e,{className:`h-3 w-3 ${s.is_verified?"text-white":"text-gray-400"}`}),e.jsx("span",{className:`${s.is_verified?"text-white":"text-gray-500"}`,children:"Verificado"})]})]})},ke=({canEditThisProfile:s,isOwner:i,onEditRequest:t,isFavorited:a,loadingFavorite:d,onToggleFavorite:o,isCreatingConversation:r,onMessageClick:h,onOpenVerificationModal:n,userVerificationStatus:g,userType:l,targetProfileType:u,onHireClick:N,layout:y="mobile"})=>{const k=i&&(["not_verified","rejected_verification","revoked_by_admin","admin_revoked"].includes(g)||!g),S=i&&g==="pending_verification",T=l&&["contractor","photographer","admin"].includes(l),I=!i&&T&&u==="model";if(s&&!k&&!S)return e.jsxs(P,{onClick:t,variant:"outline",size:"sm",className:y==="mobile"?"w-full mt-4":"w-auto",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"})," Editar Perfil"]});if(s&&(k||S))return e.jsxs("div",{className:`flex gap-2 ${y==="mobile"?"mt-4 flex-col":"w-full flex-col sm:flex-row sm:max-w-md"}`,children:[e.jsxs(P,{onClick:t,variant:"outline",size:"sm",className:y==="mobile"?"w-full":"flex-1",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"})," Editar Perfil"]}),k&&e.jsxs(P,{onClick:n,variant:"default",size:"sm",className:`${y==="mobile"?"w-full":"flex-1"} btn-gradient-outline`,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"})," Solicitar Verificação"]}),S&&e.jsxs("div",{className:`flex items-center justify-center p-2 rounded-md text-sm ${y==="mobile"?"w-full bg-yellow-50 text-yellow-700":"flex-1 bg-yellow-100 text-yellow-800"}`,children:[e.jsx(es,{className:"h-4 w-4 mr-2"})," Verificação Pendente"]})]});const b=y==="mobile-inline"?"sm":"default",M=y==="mobile-inline"?"flex-1 min-w-[calc(33.33%-0.5rem)] py-2 text-xs":"flex-1 min-w-[100px] sm:min-w-[120px]",O=y==="mobile-inline"?"flex gap-2 w-full":`flex gap-2 ${y==="mobile"?"mt-3 flex-col":"w-full flex-col sm:flex-row sm:max-w-lg"}`;return e.jsxs("div",{className:O,children:[!i&&e.jsxs(P,{onClick:o,disabled:d,variant:"outline",size:b,className:`${M} border-gray-300 text-gray-700`,children:[e.jsx(Le,{className:`h-4 w-4 mr-1.5 ${a?"text-red-500 fill-current":""}`}),a?"Favorito":"Favoritar"]}),!i&&e.jsxs(P,{onClick:h,className:`btn-gradient text-white ${M}`,size:b,disabled:r,children:[r?e.jsx(pe,{className:"h-4 w-4 mr-1.5 animate-spin"}):e.jsx(rs,{className:"h-4 w-4 mr-1.5"}),"Mensagem"]}),I&&N&&e.jsxs(P,{onClick:N,className:`bg-emerald-500 hover:bg-emerald-600 text-white ${M}`,size:b,children:[e.jsx(ee,{className:"h-4 w-4 mr-1.5"}),"Contratar"]})]})},Cs=({profile:s})=>{if(s.user_type!=="model")return null;const i=s.work_interests||[],t=s.model_characteristics||[],a=i.length>0,d=t.length>0;return!a&&!d?null:e.jsxs("div",{className:"space-y-3",children:[a&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx(ge,{className:"h-4 w-4 text-pink-500 flex-shrink-0"}),Fe.map(o=>!i.includes(o.value)&&!i.includes(o.value)?null:e.jsx(W,{variant:"default",className:"text-xs transition-all duration-200 ease-in-out bg-pink-100 text-pink-700 hover:bg-pink-200",children:o.label},`interest-${o.value}`))]}),d&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx(de,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),Pe.map(o=>!t.includes(o.value)&&!t.includes(o.value)?null:e.jsx(W,{variant:"default",className:"text-xs transition-all duration-200 ease-in-out bg-blue-100 text-blue-700 hover:bg-blue-200",children:o.label},`char-${o.value}`))]})]})};function ks(s,i){if(s==null)return{};var t={},a=Object.keys(s),d,o;for(o=0;o<a.length;o++)d=a[o],!(i.indexOf(d)>=0)&&(t[d]=s[d]);return t}var Ss=["color"],oe=x.forwardRef(function(s,i){var t=s.color,a=t===void 0?"currentColor":t,d=ks(s,Ss);return x.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d,{ref:i}),x.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.9091 12.909C13.2365 12.5817 13.4918 12.1895 13.6588 11.7577C13.8195 11.3443 13.9294 10.8718 13.961 10.1799C13.9926 9.48665 14.0001 9.26529 14.0001 7.50001C14.0001 5.73473 13.9926 5.51328 13.961 4.82008C13.9294 4.12821 13.8195 3.65573 13.6588 3.24228C13.4956 2.80857 13.2398 2.41567 12.9091 2.091C12.5844 1.76028 12.1915 1.50437 11.7578 1.34113C11.3443 1.18056 10.8718 1.0707 10.1799 1.03924C9.48675 1.00748 9.26537 1 7.50006 1C5.73476 1 5.51333 1.00748 4.82014 1.03912C4.12826 1.0707 3.65578 1.18056 3.24233 1.34125C2.80862 1.50447 2.41573 1.76032 2.09105 2.09098C1.76032 2.41563 1.5044 2.80852 1.34113 3.24225C1.18056 3.65573 1.0707 4.12821 1.03924 4.82008C1.00748 5.51328 1 5.73471 1 7.50001C1 9.26532 1.00748 9.48675 1.03924 10.1799C1.07083 10.8718 1.18069 11.3443 1.34138 11.7577C1.5046 12.1915 1.76045 12.5843 2.09111 12.909C2.41578 13.2397 2.80867 13.4955 3.24238 13.6587C3.65586 13.8194 4.12834 13.9293 4.82019 13.9609C5.51348 13.9925 5.73483 14 7.50012 14C9.2654 14 9.48685 13.9925 10.18 13.9609C10.8719 13.9293 11.3444 13.8194 11.7578 13.6587C12.1896 13.4917 12.5818 13.2364 12.9091 12.909ZM1.99949 6.73496C1.99974 6.94524 2.00005 7.19543 2.00005 7.50002C2.00005 7.80461 1.99974 8.0548 1.99949 8.26507C1.99849 9.08596 1.99824 9.29856 2.01963 9.7655C2.04625 10.3509 2.07823 10.7811 2.17588 11.1053C2.26976 11.417 2.37505 11.7342 2.7188 12.1171C3.06255 12.4999 3.39411 12.6733 3.81645 12.8007C4.23879 12.928 4.7696 12.9554 5.23052 12.9764C5.75332 13.0003 5.96052 13.0002 7.05714 12.9999L7.50006 12.9999C7.79304 12.9999 8.03569 13.0001 8.2409 13.0004C9.08195 13.0013 9.29425 13.0015 9.76575 12.9799C10.3512 12.9533 10.7814 12.9213 11.1056 12.8237C11.4173 12.7298 11.7345 12.6245 12.1173 12.2807C12.5001 11.937 12.6735 11.6054 12.8009 11.1831C12.9283 10.7607 12.9557 10.2299 12.9767 9.76902C13.0005 9.24689 13.0004 9.04027 13.0002 7.94749V7.94738L13.0001 7.50039L13.0001 7.05747C13.0004 5.96085 13.0005 5.75365 12.9766 5.23085C12.9556 4.76993 12.9282 4.23912 12.8009 3.81678C12.6735 3.39445 12.5001 3.06288 12.1173 2.71913C11.7345 2.37538 11.4172 2.27009 11.1056 2.17621C10.7813 2.07856 10.3511 2.04658 9.76571 2.01996C9.29421 1.99836 9.08194 1.99859 8.24092 1.99951H8.24092C8.0357 1.99974 7.79305 2.00001 7.50006 2.00001L7.05704 1.99993C5.96051 1.99964 5.75331 1.99958 5.23052 2.02343C4.7696 2.04446 4.23879 2.07183 3.81645 2.19921C3.39411 2.32659 3.06255 2.49999 2.7188 2.88281C2.37505 3.26562 2.26976 3.58286 2.17588 3.89453C2.07823 4.21874 2.04625 4.64894 2.01963 5.23437C1.99824 5.70131 1.99849 5.91401 1.99949 6.73496ZM7.49996 5.25015C6.25741 5.25015 5.25012 6.25744 5.25012 7.49999C5.25012 8.74254 6.25741 9.74983 7.49996 9.74983C8.74251 9.74983 9.7498 8.74254 9.7498 7.49999C9.7498 6.25744 8.74251 5.25015 7.49996 5.25015ZM4.25012 7.49999C4.25012 5.70515 5.70512 4.25015 7.49996 4.25015C9.2948 4.25015 10.7498 5.70515 10.7498 7.49999C10.7498 9.29483 9.2948 10.7498 7.49996 10.7498C5.70512 10.7498 4.25012 9.29483 4.25012 7.49999ZM10.9697 4.7803C11.3839 4.7803 11.7197 4.44452 11.7197 4.0303C11.7197 3.61609 11.3839 3.2803 10.9697 3.2803C10.5555 3.2803 10.2197 3.61609 10.2197 4.0303C10.2197 4.44452 10.5555 4.7803 10.9697 4.7803Z",fill:a}))});const Ms=({profile:s,canViewPrivateInfo:i})=>{const t=je(),a=(l,u)=>{t(l,{state:u})},d=({icon:l,label:u})=>{const N=l;return e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gray-50/50",children:[e.jsx(N,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:u})]})},o=l=>l?`https://instagram.com/${l.replace("@","")}`:null,r=l=>{if(!l)return null;const u=l.replace(/\D/g,""),N=encodeURIComponent("Te encontrei no sistema do Banco de Modelos e tenho interesse em te contratar");return`https://wa.me/55${u}?text=${N}`},h=l=>{if(!l)return"Não informado";const u=l.replace(/\D/g,"");return u.length!==11&&u.length!==10?l:`(${u.substring(0,2)}) ${u.substring(2,u.length===11?7:6)}-${u.substring(u.length===11?7:6)}`},n=o(s.instagram_handle),g=r(s.phone);return e.jsx("div",{className:`p-4 rounded-lg w-full ${i?"bg-green-50/70 border-green-200 border":"bg-gray-100"}`,children:i?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-y-3 gap-x-4 items-center text-left",children:[g?e.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-start gap-3 hover:text-pink-600 group",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-500 group-hover:text-pink-500"}),e.jsx("span",{className:"text-lg font-medium",children:h(s.phone)})]}):e.jsxs("div",{className:"flex items-center justify-start gap-3",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-500"}),e.jsx("span",{className:"text-lg font-medium",children:h(s.phone)})]}),e.jsxs("div",{className:"flex items-center justify-start gap-3",children:[e.jsx(se,{className:"h-5 w-5 text-gray-500"}),e.jsx("span",{className:"text-lg font-medium truncate",children:s.email})]}),n&&s.instagram_handle?e.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-start gap-3 hover:text-pink-600 group",children:[e.jsx(oe,{className:"h-5 w-5 text-gray-500 group-hover:text-pink-500"}),e.jsxs("span",{className:"text-lg font-medium",children:["@",s.instagram_handle]})]}):s.instagram_handle&&e.jsxs("div",{className:"flex items-center justify-start gap-3",children:[e.jsx(oe,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-lg font-medium",children:["@",s.instagram_handle]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-center gap-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-2 justify-center",children:[e.jsx(d,{icon:Y,label:"WhatsApp"}),e.jsx(d,{icon:se,label:"Email"}),s.instagram_handle&&e.jsx(d,{icon:oe,label:"Instagram"})]}),e.jsxs(P,{size:"sm",className:"btn-gradient text-white mt-2 w-full max-w-xs sm:w-auto",onClick:()=>a("/dashboard",{tab:"subscription"}),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"})," Ver Contatos"]})]})})},Fs=({profile:s,onOpenVerificationModal:i,onOpenHireModal:t})=>{const{user:a,openAuthModal:d,refreshAuthUser:o}=ae(),{toast:r}=J(),h=je(),n=a&&a.id===s.id,g=a&&a.user_type==="admin"&&a.id!==s.id,l=n||g,u=a&&a.subscription_type==="pro",N=n||u||a&&a.user_type==="admin",[y,$]=x.useState({media:0,jobs:0,rating:0}),[k,S]=x.useState(!1),[T,I]=x.useState(!1),[b,M]=x.useState(!1),[O,c]=x.useState(!1),p=(s==null?void 0:s.user_type)==="model",f=(s==null?void 0:s.user_type)==="model"||(s==null?void 0:s.user_type)==="photographer"||(s==null?void 0:s.user_type)==="contractor";x.useEffect(()=>{(async()=>{if(s.id)try{let E=0;if(f){const{count:D}=await F.from("profile_photos").select("id",{count:"exact",head:!0}).eq("profile_id",s.id),{count:v}=await F.from("profile_videos").select("id",{count:"exact",head:!0}).eq("profile_id",s.id);E=(D||0)+(v||0)}let V=0;if(s.user_type==="model"){const{count:D}=await F.from("job_applications").select("id",{count:"exact",head:!0}).eq("model_id",s.id);V=D||0}else{const{count:D}=await F.from("jobs").select("id",{count:"exact",head:!0}).eq("created_by",s.id);V=D||0}if($({media:E,jobs:V,rating:Number(s.avg_rating||0).toFixed(1)}),a&&!n){const{data:D,error:v}=await F.from("user_favorites").select("*").eq("user_id",a.id).eq("favorited_profile_id",s.id).maybeSingle();if(v)throw v;S(!!D)}}catch(E){console.error("Erro ao buscar estatísticas ou favoritos:",E)}})()},[s,a,n,f]);const _=async()=>{if(!a){d("login");return}if(!n){I(!0);try{if(k){const{error:j}=await F.from("user_favorites").delete().match({user_id:a.id,favorited_profile_id:s.id});if(j)throw j;S(!1),r({title:"Removido dos Favoritos"})}else{const{error:j}=await F.from("user_favorites").insert({user_id:a.id,favorited_profile_id:s.id});if(j)throw j;S(!0),r({title:"Adicionado aos Favoritos!"})}}catch(j){r({title:"Erro",description:j.message,variant:"destructive"})}finally{I(!1)}}},m=async()=>{if(!a){d();return}if(!n){if(a.user_type==="model"&&s.user_type!=="admin"){r({title:"Ação não permitida",description:"Modelos podem iniciar conversas apenas com administradores.",variant:"destructive"});return}if(!u&&a.user_type!=="admin"){r({title:"Acesso Exclusivo Pro",description:"Apenas assinantes Pro ou Administradores podem enviar mensagens. Faça o upgrade para se conectar!",variant:"destructive"}),h("/dashboard",{state:{tab:"subscription"}});return}M(!0);try{let j,E;a.user_type==="model"?(E=a.id,j=s.id):(j=a.id,E=s.id);const{data:V,error:D}=await F.rpc("get_or_create_conversation",{p_hirer_id:j,p_model_id:E});if(D)throw D;h("/mensagens",{state:{profile:s,conversationId:V[0].id}})}catch(j){r({title:"Erro ao iniciar conversa",description:j.message,variant:"destructive"})}finally{M(!1)}}},C=j=>{c(!1),o(),r({title:"Perfil Atualizado",description:`Dados de ${j.name||"usuário"} salvos.`,variant:"success"}),window.location.reload()},A=()=>{navigator.clipboard.writeText(window.location.href),r({title:"Link Copiado!",description:"O link do perfil foi copiado para sua área de transferência."})},H=j=>(j==null?void 0:j.subscription_type)==="pro"&&(j==null?void 0:j.subscription_expires_at)&&new Date(j.subscription_expires_at)>new Date,G=[s.city,s.state].filter(Boolean).join(", ");let q="";p?q=[s.model_physical_type,s.model_profile_category,G].filter(Boolean).join(" - "):q=[s.company_name,G].filter(Boolean).join(" - ");const B=H(s);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mb-8",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("div",{className:"sm:hidden",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-shrink-0 w-20",children:[e.jsxs("div",{className:"relative w-20 h-20 cursor-pointer",onClick:l?()=>c(!0):void 0,children:[e.jsx("img",{className:"w-full h-full rounded-full border-2 border-gray-200 object-cover bg-gray-200 shadow-sm",alt:`Foto de perfil de ${s.name}`,src:s.profile_image_url||`https://api.dicebear.com/7.x/micah/svg?seed=${s.name||s.id}`}),l&&e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white p-1.5 rounded-full shadow-md hover:bg-gray-100 transition-colors border border-gray-200",children:e.jsx(ve,{className:"w-3 h-3 text-gray-600"})})]}),e.jsx(Ce,{profile:s,isProActive:B,layout:"mobile"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 truncate",children:s.name}),s.is_verified&&e.jsx($e,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),B&&e.jsx(Me,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mb-1",children:q||"Detalhes não informados"}),p&&s.cache_value>0&&e.jsx("div",{className:"mt-1 mb-2",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-emerald-100 text-emerald-800 font-semibold text-xs px-2 py-1 rounded-full",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsxs("span",{children:["Cachê a partir de R$ ",Number(s.cache_value).toFixed(2).replace(".",",")]})]})}),e.jsx(we,{stats:y,profile:s,canHaveGallery:f,layout:"mobile"}),e.jsx("div",{className:"mt-2",children:e.jsx(ke,{canEditThisProfile:l,isOwner:n,onEditRequest:()=>c(!0),isFavorited:k,loadingFavorite:T,onToggleFavorite:_,isCreatingConversation:b,onMessageClick:m,onOpenVerificationModal:i,userVerificationStatus:s.verification_status,userType:a==null?void 0:a.user_type,targetProfileType:s==null?void 0:s.user_type,onHireClick:()=>t&&t(s),layout:"mobile-inline"})})]})]})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-6",children:[e.jsxs("div",{className:"relative w-28 h-28 flex-shrink-0 cursor-pointer",onClick:l?()=>c(!0):void 0,children:[e.jsx("img",{className:"w-full h-full rounded-full border-4 border-white object-cover bg-gray-200 shadow-md",alt:`Foto de perfil de ${s.name}`,src:s.profile_image_url||`https://api.dicebear.com/7.x/micah/svg?seed=${s.name||s.id}`}),l&&e.jsx("div",{className:"absolute bottom-0 right-0 bg-white p-2 rounded-full shadow-md hover:bg-gray-100 transition-colors",children:e.jsx(ve,{className:"w-4 h-4 text-gray-700"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsx(Ce,{profile:s,isProActive:B,layout:"desktop"}),e.jsx(ms,{children:e.jsxs(xs,{children:[e.jsx(hs,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full ml-2",onClick:A,children:e.jsx(Te,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(us,{children:e.jsx("p",{children:"Copiar link do perfil"})})]})})]}),p&&s.cache_value>0&&e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-100 text-emerald-800 font-bold text-sm px-3 py-1.5 rounded-full",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsxs("span",{children:["Cachê a partir de R$ ",Number(s.cache_value).toFixed(2).replace(".",",")]})]})}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:q||"Detalhes não informados"}),e.jsx("div",{className:"flex justify-start gap-8 w-full mb-3",children:e.jsx(we,{stats:y,profile:s,canHaveGallery:f,layout:"desktop"})}),e.jsx("div",{className:"mt-4",children:e.jsx(ke,{canEditThisProfile:l,isOwner:n,onEditRequest:()=>c(!0),isFavorited:k,loadingFavorite:T,onToggleFavorite:_,isCreatingConversation:b,onMessageClick:m,onOpenVerificationModal:i,userVerificationStatus:s.verification_status,userType:a==null?void 0:a.user_type,targetProfileType:s==null?void 0:s.user_type,onHireClick:()=>t&&t(s),layout:"desktop"})})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 flex flex-col items-stretch gap-4",children:[p&&e.jsx("div",{className:"w-full",children:e.jsx(Cs,{profile:s})}),e.jsx("div",{className:"w-full",children:e.jsx(Ms,{profile:s,canViewPrivateInfo:N,onNavigate:j=>h(`/${j}`)})})]})]})}),e.jsx(te,{open:O,onOpenChange:c,children:e.jsxs(re,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Editar Perfil"}),e.jsxs(le,{children:["Modifique os dados de ",s.name,"."]})]}),e.jsx(is,{initialProfileData:s,onSuccess:C,onCancel:()=>c(!1),viewMode:g?"admin":"user"})]})})]})},Ps=({tabs:s=[],activeTab:i,onTabChange:t})=>e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex justify-center items-center space-x-8",children:s.map(a=>{const d=a.icon;return e.jsxs("button",{onClick:()=>t(a.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${i===a.id?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-900 hover:border-gray-400"}`,children:[e.jsx(d,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:a.label})]},a.id)})})}),w=({icon:s,label:i,value:t,isPlaceholder:a=!1,children:d})=>{const o=s;return!t&&!d&&!a&&t!==0&&t!=="0"?null:e.jsxs("div",{className:"flex items-start group",children:[e.jsx(o,{className:"h-5 w-5 text-gray-400 mr-3 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:i}),d?e.jsx("div",{className:"font-medium text-gray-800",children:d}):e.jsx("p",{className:`font-medium ${a&&!t?"text-gray-400 italic":"text-gray-800"}`,children:t||"Não informado"})]})]})},Se=({icon:s,label:i,onNavigate:t})=>{const a=s;return e.jsxs("div",{className:"flex items-start group relative bg-gray-50 p-4 rounded-lg border border-dashed",children:[e.jsxs("div",{className:"absolute inset-0 bg-white/70 backdrop-blur-sm flex flex-col items-center justify-center z-10",children:[e.jsx(Ie,{className:"h-6 w-6 text-yellow-500 mb-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Conteúdo Exclusivo"}),e.jsx(P,{size:"sm",variant:"link",className:"text-pink-600 h-auto p-0 mt-1",onClick:()=>t("dashboard",null,{tab:"subscription"}),children:"Seja Premium para ver"})]}),e.jsx(a,{className:"h-5 w-5 text-gray-400 mr-3 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:i}),e.jsx("p",{className:"font-medium text-gray-400 italic",children:"Apenas para assinantes"})]})]})},Es=({profile:s,user:i,onNavigate:t})=>{const a=s.user_type==="model",d=["contractor","photographer"].includes(s.user_type),o=i&&i.subscription_type==="pro",r=i&&i.id===s.id,h=r||o||i&&i.user_type==="admin",n=(g,l)=>{const u=g.find(N=>N.value===l);return u?u.label:l};return e.jsxs("div",{className:"space-y-8",children:[s.bio&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4 border-b pb-2",children:"Bio"}),e.jsx("p",{className:"text-gray-600 leading-relaxed whitespace-pre-wrap",children:s.bio})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4 border-b pb-2",children:"Informações Gerais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:[e.jsx(w,{icon:fe,label:"Nome Artístico/Social",value:s.name,isPlaceholder:r}),s.display_age&&e.jsx(w,{icon:ss,label:"Idade (Exibição)",value:`${s.display_age} anos`}),e.jsx(w,{icon:ps,label:"Localização",value:s.city&&s.state?`${s.city}, ${s.state}`:null,isPlaceholder:r}),a&&e.jsxs(e.Fragment,{children:[e.jsx(w,{icon:Ee,label:"Gênero",value:n(Oe,s.gender),isPlaceholder:r}),e.jsx(w,{icon:qe,label:"Tipo (Aparência)",value:n(Ve,s.model_type),isPlaceholder:r}),e.jsx(w,{icon:ze,label:"Perfil Físico",value:n(Be,s.model_physical_type),isPlaceholder:r}),e.jsx(w,{icon:Ns,label:"Altura",value:s.height?`${s.height} cm`:null,isPlaceholder:r}),e.jsx(w,{icon:ws,label:"Peso",value:s.weight?`${s.weight} kg`:null,isPlaceholder:r}),e.jsx(w,{icon:Ue,label:"Cor do cabelo",value:s.hair_color?n(He,s.hair_color):null,isPlaceholder:r}),e.jsx(w,{icon:Ge,label:"Cor dos olhos",value:s.eye_color?n(Ze,s.eye_color):null,isPlaceholder:r}),e.jsx(w,{icon:bs,label:"Sapato",value:s.shoe_size?n(Ke,s.shoe_size):null,isPlaceholder:r}),e.jsx(w,{icon:ee,label:"Cachê (base)",value:s.cache_value?`R$ ${Number(s.cache_value).toFixed(2).replace(".",",")}`:null,isPlaceholder:r})]}),d&&e.jsxs(e.Fragment,{children:[e.jsx(w,{icon:We,label:"Nome da Empresa (Opcional)",value:s.company_name,isPlaceholder:r}),e.jsx(w,{icon:Te,label:"Site (Opcional)",value:s.company_website,isPlaceholder:r}),e.jsx(w,{icon:fe,label:"Detalhes da Empresa (Opcional)",value:s.company_details,isPlaceholder:r})]})]})]}),a&&s.model_characteristics&&s.model_characteristics.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4 border-b pb-2",children:"Características"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.model_characteristics.map((g,l)=>e.jsxs(W,{variant:"secondary",className:"text-sm bg-blue-100 text-blue-700 hover:bg-blue-200",children:[e.jsx(de,{className:"h-3.5 w-3.5 mr-1.5"}),n(Pe,g)]},l))})]}),a&&s.work_interests&&s.work_interests.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4 border-b pb-2",children:"Interesses de Trabalho"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.work_interests.map((g,l)=>e.jsxs(W,{variant:"secondary",className:"text-sm bg-pink-100 text-pink-700 hover:bg-pink-200",children:[e.jsx(ge,{className:"h-3.5 w-3.5 mr-1.5"}),n(Fe,g)]},l))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 border-b pb-2 flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-yellow-500"})," Informações Exclusivas"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4",children:h?e.jsxs(e.Fragment,{children:[e.jsx(w,{icon:se,label:"Email",value:s.email}),e.jsx(w,{icon:Y,label:"Telefone",value:s.phone,isPlaceholder:r})]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{icon:se,label:"Email",onNavigate:t}),e.jsx(Se,{icon:Y,label:"Telefone",onNavigate:t})]})})]})]})},ce=({file:s,setFile:i,title:t="Foto do Documento (Frente)",description:a="Arraste ou clique para enviar. (PNG, JPG, PDF até 5MB)"})=>{const d=x.useCallback(u=>{u.length>0&&i(u[0])},[i]),{getRootProps:o,getInputProps:r,isDragActive:h,fileRejections:n}=as({onDrop:d,accept:{"image/jpeg":[],"image/png":[],"application/pdf":[]},maxSize:5*1024*1024,multiple:!1}),g=u=>{u.stopPropagation(),i(null)},l=n.length>0&&n[0].errors[0].code==="file-too-large";return e.jsxs("div",{...o(),className:`relative p-4 text-center border-2 border-dashed rounded-xl cursor-pointer transition-colors ${h?"border-pink-500 bg-pink-50":"border-gray-300 hover:border-gray-400 bg-gray-50"}`,children:[e.jsx("input",{...r()}),s?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(ys,{className:"w-10 h-10 text-green-500"}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-800 truncate max-w-full",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Math.round(s.size/1024)," KB"]}),e.jsx(P,{variant:"ghost",size:"icon",onClick:g,className:"absolute top-1 right-1 h-6 w-6 rounded-full bg-gray-200 hover:bg-gray-300",children:e.jsx(Ye,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(ns,{className:"w-10 h-10 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm font-semibold text-gray-700",children:t}),e.jsx("p",{className:"text-xs text-gray-500",children:a}),h&&e.jsx("p",{className:"mt-1 text-sm text-pink-600",children:"Solte o arquivo aqui!"}),l&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Arquivo muito grande! Máx 5MB."})]})]})},Ds=({isOpen:s,onClose:i,onSuccess:t})=>{var M,O;const{user:a,refreshAuthUser:d}=ae(),{toast:o}=J(),[r,h]=x.useState(!1),[n,g]=x.useState({full_name:(a==null?void 0:a.legal_full_name)||"",birth_date:(a==null?void 0:a.birth_date)||"",cpf:(a==null?void 0:a.cpf)||"",document_type:(a==null?void 0:a.document_type)||"rg_frente_verso",pix_key_type:((M=a==null?void 0:a.pix_info)==null?void 0:M.type)||"cpf",pix_key:((O=a==null?void 0:a.pix_info)==null?void 0:O.key)||(a==null?void 0:a.cpf)||"",document_front:null,document_back:null,document_selfie:null}),[l,u]=x.useState({}),N=x.useCallback(c=>{const{name:p,value:f}=c.target;g(_=>({..._,[p]:f}))},[]),y=x.useCallback((c,p)=>{g(f=>({...f,[c]:p}))},[]),$=x.useCallback((c,p)=>{g(f=>({...f,[c]:p}))},[]),k=c=>{const p=os(c.target.value);g(f=>{const _={...f,cpf:p};return _.pix_key_type==="cpf"&&(_.pix_key=p),_})},S=c=>{g(p=>{const f={...p,pix_key_type:c};return c==="cpf"?f.pix_key=f.cpf:f.pix_key="",f})},T=c=>{g(p=>({...p,pix_key:cs(c.target.value,p.pix_key_type)}))},I=async c=>{c.preventDefault();const p={...n,cpf:n.cpf.replace(/\D/g,""),pix_key:n.pix_key_type==="cpf"||n.pix_key_type==="cnpj"||n.pix_key_type==="phone"?n.pix_key.replace(/\D/g,""):n.pix_key},f=ds(p);if(u(f),Object.keys(f).length>0){o({title:"Campos inválidos",description:"Por favor, preencha todos os campos obrigatórios corretamente.",variant:"destructive"});return}h(!0);try{const _=Date.now(),m=async(q,B)=>{if(!q)return null;const j=`verifications/${a.id}/${_}/${B}.${q.name.split(".").pop()}`,{error:E}=await F.storage.from("user_media").upload(j,q);if(E)throw new Error(`Erro no upload (${B}): ${E.message}`);const{data:V}=F.storage.from("user_media").getPublicUrl(j);return V.publicUrl},[C,A,H]=await Promise.all([m(n.document_front,"doc_front"),m(n.document_back,"doc_back"),m(n.document_selfie,"doc_selfie")]),{error:G}=await F.rpc("request_new_verification",{p_user_id:a.id,p_full_name:p.full_name,p_birth_date:p.birth_date,p_cpf:p.cpf,p_document_type:p.document_type,p_pix_key_type:p.pix_key_type,p_pix_key:p.pix_key,p_document_front_image_url:C,p_document_back_image_url:A,p_document_selfie_url:H});if(G)throw G;o({title:"Solicitação Enviada!",description:"Seus documentos foram enviados para análise. Avisaremos quando o processo for concluído."}),await d(),t()}catch(_){o({title:"Erro ao enviar solicitação",description:_.message,variant:"destructive"})}finally{h(!1)}},b=Ne.find(c=>c.value===n.document_type);return e.jsx(te,{open:s,onOpenChange:i,children:e.jsxs(re,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Solicitar Verificação de Perfil"}),e.jsx(le,{children:"Envie seus documentos para obter o selo de verificado e aumentar sua credibilidade."})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6 p-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"full_name",children:"Nome Completo (como no documento)"}),e.jsx(K,{id:"full_name",name:"full_name",value:n.full_name,onChange:N,disabled:r}),l.full_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.full_name})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"birth_date",children:"Data de Nascimento"}),e.jsx(K,{id:"birth_date",name:"birth_date",type:"date",value:n.birth_date,onChange:N,disabled:r}),l.birth_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.birth_date})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"cpf",children:"CPF"}),e.jsx(K,{id:"cpf",name:"cpf",placeholder:"000.000.000-00",value:n.cpf,onChange:k,disabled:r}),l.cpf&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.cpf})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"document_type",children:"Tipo de Documento"}),e.jsxs(me,{value:n.document_type,onValueChange:c=>y("document_type",c),disabled:r,children:[e.jsx(xe,{children:e.jsx(he,{})}),e.jsx(ue,{children:Ne.map(c=>e.jsx(X,{value:c.value,children:c.label},c.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"pix_key_type",children:"Tipo de Chave PIX"}),e.jsxs(me,{value:n.pix_key_type,onValueChange:S,disabled:r,children:[e.jsx(xe,{children:e.jsx(he,{})}),e.jsx(ue,{children:ls.map(c=>e.jsx(X,{value:c.value,children:c.label},c.value))})]})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"pix_key",children:"Chave PIX"}),e.jsx(K,{id:"pix_key",name:"pix_key",value:n.pix_key,onChange:T,disabled:r||n.pix_key_type==="cpf"}),l.pix_key&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.pix_key})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{children:"Documentos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(ce,{file:n.document_front,setFile:c=>$("document_front",c),title:(b==null?void 0:b.files)===1?"Documento (Imagem Única)":"Documento (Frente)"}),(b==null?void 0:b.files)===2&&e.jsx(ce,{file:n.document_back,setFile:c=>$("document_back",c),title:"Documento (Verso)"}),e.jsx(ce,{file:n.document_selfie,setFile:c=>$("document_selfie",c),title:"Selfie com Documento"})]}),l.document_front&&e.jsx("p",{className:"text-red-500 text-xs -mt-2",children:l.document_front}),l.document_back&&e.jsx("p",{className:"text-red-500 text-xs -mt-2",children:l.document_back}),l.document_selfie&&e.jsx("p",{className:"text-red-500 text-xs -mt-2",children:l.document_selfie})]})]}),e.jsxs(De,{children:[e.jsx(P,{variant:"outline",onClick:i,disabled:r,children:"Cancelar"}),e.jsxs(P,{onClick:I,disabled:r,className:"btn-gradient text-white",children:[r&&e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviar para Análise"]})]})]})})},$s=({isOpen:s,onClose:i,modelProfile:t,jobDetails:a=null})=>{var f,_;const{user:d,appSettings:o}=ae();J();const r=()=>{const m=new Date;m.setDate(m.getDate()+1),m.setHours(12,0,0,0);const C=m.getTimezoneOffset();return new Date(m.getTime()-C*60*1e3).toISOString().slice(0,16)},[h,n]=x.useState({serviceDateTime:r(),serviceDescription:"",workInterestCategory:""}),[g,l]=x.useState(""),[u,N]=x.useState(0),[y,$]=x.useState(0),[k,S]=x.useState(0),[T,I]=x.useState(!1);o==null||o.MERCADOPAGO_PUBLIC_KEY,x.useEffect(()=>{const m=parseFloat((o==null?void 0:o.PLATFORM_HIRING_FEE_PERCENTAGE)||(t==null?void 0:t.platform_fee_on_hiring)||"10");N(m)},[o,t]),x.useEffect(()=>{const m=ye(g);if(!isNaN(m)&&u>0){const C=m*u/100;$(C),S(m+C)}else $(0),S(m>0?m:0)},[g,u]),x.useEffect(()=>{var m;if(s){const C=(t==null?void 0:t.cache_value)||"";n({serviceDateTime:r(),serviceDescription:(a==null?void 0:a.description)||"",workInterestCategory:(a==null?void 0:a.job_type)||((m=t==null?void 0:t.work_interests)==null?void 0:m[0])||""}),l(be(String(C)))}},[s,t,a]);const b=m=>{const{name:C,value:A}=m.target;n(H=>({...H,[C]:A}))},M=m=>{l(be(m.target.value))},O=(m,C)=>{n(A=>({...A,[m]:C}))},c=async m=>{m.preventDefault(),I(!0)},p=()=>e.jsx(P,{type:"submit",className:"w-full btn-gradient text-white",children:"Enviar Proposta"});return t?e.jsxs(e.Fragment,{children:[e.jsx(ts,{isOpen:T,onClose:()=>I(!1)}),e.jsx(te,{open:s,onOpenChange:m=>{m||i()},children:e.jsxs(re,{className:"sm:max-w-lg",children:[e.jsxs(ie,{children:[e.jsxs(ne,{children:["Contratar ",t.name]}),e.jsx(le,{children:"Preencha os detalhes para enviar sua proposta."})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4 pt-4",children:[e.jsxs("div",{children:[e.jsx(L,{htmlFor:"serviceDateTime",children:"Data e Hora do Serviço"}),e.jsx(K,{id:"serviceDateTime",name:"serviceDateTime",type:"datetime-local",value:h.serviceDateTime,onChange:b,required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"workInterestCategory",children:"Categoria do Trabalho"}),e.jsxs(me,{name:"workInterestCategory",value:h.workInterestCategory,onValueChange:m=>O("workInterestCategory",m),children:[e.jsx(xe,{className:"mt-1",children:e.jsx(he,{placeholder:"Selecione uma categoria"})}),e.jsxs(ue,{children:[((f=t.work_interests)==null?void 0:f.length)>0?t.work_interests.map(m=>e.jsx(X,{value:m,children:m},m)):e.jsx(X,{value:"geral",disabled:!0,children:"Nenhum interesse listado"}),(a==null?void 0:a.job_type)&&!((_=t.work_interests)!=null&&_.includes(a.job_type))&&e.jsxs(X,{value:a.job_type,children:[a.job_type," (Específico da Vaga)"]},a.job_type)]})]})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"serviceDescription",children:"Descrição do Serviço"}),e.jsx(Qe,{id:"serviceDescription",name:"serviceDescription",value:h.serviceDescription,onChange:b,placeholder:"Descreva o trabalho a ser realizado...",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(L,{htmlFor:"agreedCache",children:"Cachê Proposto (R$)"}),e.jsx(K,{id:"agreedCache",name:"agreedCache",type:"text",inputMode:"decimal",value:g,onChange:M,placeholder:"Ex: 250,00",required:!0,className:"mt-1"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md border border-gray-200 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cachê:"}),e.jsxs("span",{children:["R$ ",ye(g).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Taxa da Plataforma (",u.toFixed(1).replace(".",","),"%):"]}),e.jsxs("span",{children:["R$ ",y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("hr",{className:"my-1 border-gray-300"}),e.jsxs("div",{className:"flex justify-between font-semibold text-base",children:[e.jsx("span",{children:"Total a Pagar:"}),e.jsxs("span",{children:["R$ ",k.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:e.jsxs("p",{children:[e.jsx("strong",{children:"IMPORTANTE:"})," Enviar o pedido não garante a contratação. A modelo poderá aceitar ou recusar o serviço e você receberá uma notificação com a resposta dela. Caso a modelo não aceite a proposta ou o serviço não seja realizado, o valor será devolvido para a sua carteira."]})}),e.jsxs(De,{className:"sm:justify-start pt-2",children:[p(),e.jsx(Xe,{asChild:!0,children:e.jsx(P,{type:"button",variant:"outline",className:"w-full mt-2 sm:mt-0",children:"Cancelar"})})]})]})]})})]}):null},Ts=({currentProfileId:s})=>{const[i,t]=x.useState([]),[a,d]=x.useState(!0),{toast:o}=J();return je(),x.useEffect(()=>{(async()=>{d(!0);try{const{data:h,error:n}=await F.from("profiles").select("*").eq("user_type","model").neq("id",s).order("subscription_type",{ascending:!1,nullsLast:!0}).limit(4);if(n)throw n;t(h||[])}catch(h){h.code!=="SUPABASE_INIT_ERROR"&&o({title:"Erro ao buscar sugestões",description:h.message,variant:"destructive"}),console.error("Erro ao buscar modelos sugeridos:",h)}finally{d(!1)}})()},[s,o]),a?e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 text-center sm:text-left",children:"Outras Modelos"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:Array.from({length:4}).map((r,h)=>e.jsx("div",{className:"rounded-xl bg-gray-200 animate-pulse aspect-[3/4]"},h))})]}):i.length===0?null:e.jsxs("div",{className:"mt-12",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 text-center sm:text-left flex items-center justify-center sm:justify-start gap-2",children:[e.jsx(Ee,{className:"h-7 w-7 text-pink-500"})," ",e.jsxs("span",{children:["Explore ",e.jsx("span",{className:"gradient-text",children:"Outras Modelos"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:i.map(r=>e.jsx(js,{model:r},r.id))})]})},Ys=({profile:s})=>{var D;const{user:i,openAuthModal:t}=ae(),{toast:a}=J(),d=(s==null?void 0:s.user_type)==="model"||(s==null?void 0:s.user_type)==="photographer"||(s==null?void 0:s.user_type)==="contractor",o=x.useRef(null),[r,h]=x.useState(!1),[n,g]=x.useState(!1),[l,u]=x.useState(!1),[N,y]=x.useState(null),[$,k]=x.useState("add"),[S,T]=x.useState(null),[I,b]=x.useState(null),M=[...d?[{id:"gallery",label:"Galeria",icon:_s}]:[],{id:"about",label:"Sobre",icon:Je}],O=((D=M[0])==null?void 0:D.id)||"about",[c,p]=x.useState(O),[f,_]=x.useState(0);x.useEffect(()=>{if(s){const v=s.user_type==="model"||s.user_type==="photographer"||s.user_type==="contractor"?"gallery":"about";p(v)}},[s]);const m=x.useCallback(v=>{if(!i){t("login");return}if(i.id===v.id){a({title:"Ação Inválida",description:"Você não pode contratar a si mesmo.",variant:"warning"});return}if(i.user_type==="model"){a({title:"Ação não permitida",description:"Modelos não podem contratar outros usuários.",variant:"warning"});return}y(v),u(!0)},[i,t,a]),C=()=>{u(!1),y(null)},A=()=>{h(!1),T(null),b(null)},H=()=>{var v;(v=o.current)==null||v.click()},G=v=>{var z;const R=(z=v.target.files)==null?void 0:z[0];if(!R)return;const Q=["image/jpeg","image/png","image/gif","image/webp","image/heic","image/heif"],Z=["video/mp4","video/webm","video/quicktime"];if(Q.includes(R.type)||Z.includes(R.type)){if(R.type.startsWith("video/")&&R.size>50*1024*1024){a({title:"Vídeo muito grande",description:"O tamanho máximo é 50MB.",variant:"destructive"});return}b(R),k("add"),T(null),h(!0)}else a({title:"Tipo de arquivo não suportado",description:`O formato ${R.type} não é aceito.`,variant:"destructive"});v.target.value=""},q=v=>{T(v),k("edit"),b(null),h(!0)},B=async v=>{try{const R=v.type==="photo"?"profile_photos":"profile_videos",{error:Q}=await F.from(R).delete().eq("id",v.id);if(Q)throw Q;const Z=[];if(v.url){const z=new URL(v.url).pathname.split("/user_media/")[1];z&&Z.push(z)}if(v.type==="video"&&v.thumb){const z=new URL(v.thumb).pathname.split("/user_media/")[1];z&&Z.push(z)}Z.length>0&&await F.storage.from("user_media").remove(Z),a({title:"Mídia excluída!",description:"O item foi removido da sua galeria."}),_(z=>z+1)}catch(R){a({title:"Erro ao excluir",description:R.message,variant:"destructive"})}},j=()=>{A(),_(v=>v+1)},E=()=>{g(!1),window.location.reload()};if(!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(pe,{className:"h-12 w-12 text-pink-500 animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Carregando perfil..."})]})});const V=(i==null?void 0:i.id)===s.id;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(Fs,{profile:s,onOpenVerificationModal:()=>g(!0),onOpenHireModal:m}),e.jsxs("div",{className:"mt-8",children:[e.jsx(Ps,{tabs:M,activeTab:c,onTabChange:p}),e.jsxs("div",{className:"mt-6",children:[c==="gallery"&&d&&e.jsx(gs,{profileId:s.id,isOwner:V,onAddMedia:H,onEditRequest:q,onDeleteRequest:B},f),c==="about"&&e.jsx(Es,{profile:s})]})]}),s.user_type==="model"&&e.jsx(Ts,{currentProfileId:s.id})]})}),e.jsx("input",{type:"file",ref:o,onChange:G,accept:"image/jpeg,image/png,image/gif,image/webp,image/heic,image/heif,video/mp4,video/webm,video/quicktime",className:"hidden"}),e.jsx(te,{open:r,onOpenChange:v=>!v&&A(),children:e.jsxs(re,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:$==="add"?"Adicionar Nova Mídia":"Editar Mídia"}),e.jsx(le,{children:$==="add"?"Prepare sua mídia para publicação.":"Atualize a capa ou a legenda da sua mídia."})]}),e.jsx(vs,{mediaItem:S,file:I,onSuccess:j,onCancel:A})]})}),V&&e.jsx(Ds,{isOpen:n,onClose:()=>g(!1),onSuccess:E}),e.jsx($s,{isOpen:l,onClose:C,modelProfile:N})]})};export{Ys as default};
